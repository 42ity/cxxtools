<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>iniclass.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Erzeugt von Doxygen 1.2.9.1 -->
<center>
<a class="qindex" href="index.html">Hauptseite</a> &nbsp; <a class="qindex" href="hierarchy.html">Klassenhierarchie</a> &nbsp; <a class="qindex" href="annotated.html">Übersicht</a> &nbsp; <a class="qindex" href="files.html">Auflistung der Dateien</a> &nbsp; <a class="qindex" href="functions.html">Elementübersicht</a> &nbsp; </center>
<hr><h1>iniclass.h</h1><div class="fragment"><pre>00001 
00002 <font class="comment">// iniclass.h</font>
00003 <font class="comment">//</font>
00004 <font class="comment">// Author: Tommi Mäkitalo, Dr. Eckhardt + Partner GmbH</font>
00005 <font class="comment">// Datum:  13.3.2002</font>
00006 <font class="comment">//</font>
00007 
00008 <font class="preprocessor">#ifndef INILIB_H</font>
00009 <font class="preprocessor"></font><font class="preprocessor">#define INILIB_H</font>
00010 <font class="preprocessor"></font>
00011 <font class="preprocessor">#include &lt;iostream&gt;</font>
00012 <font class="preprocessor">#include &lt;strstream&gt;</font>
00013 <font class="preprocessor">#include &lt;fstream&gt;</font>
00014 <font class="preprocessor">#include &lt;map&gt;</font>
00015 
00016 <font class="keyword">class </font>IniFile : <font class="keyword">public</font> std::map&lt;std::string, std::map&lt;std::string, std::string&gt; &gt;
00017 {
00018   <font class="keyword">public</font>:
00019     <font class="keyword">typedef</font> std::string   section_name_type;
00020     <font class="keyword">typedef</font> mapped_type   section_type;
00021     <font class="keyword">typedef</font> std::string   token_name_type;
00022     <font class="keyword">typedef</font> std::string   token_type;
00023     <font class="keyword">typedef</font> section_type::iterator       section_iterator;
00024     <font class="keyword">typedef</font> section_type::const_iterator const_section_iterator;
00025 
00026     IniFile()<font class="keyword"></font>
00027 <font class="keyword">    </font>{ }
00028 
00029     IniFile(<font class="keyword">const</font> <font class="keywordtype">char</font>* filename)<font class="keyword"></font>
00030 <font class="keyword">    </font>{ Read(filename); }
00031 
00032     IniFile(std::istream&amp; in)<font class="keyword"></font>
00033 <font class="keyword">    </font>{ Read(in); }
00034 
00035     <font class="keywordtype">void</font> Read(std::istream&amp; in);
00036     <font class="keywordtype">void</font> Read(<font class="keyword">const</font> <font class="keywordtype">char</font>* filename)<font class="keyword"></font>
00037 <font class="keyword">    </font>{ Read(std::ifstream(filename)); }
00038 
00039     <font class="keywordtype">bool</font> Exists(std::string section)<font class="keyword"> const</font>
00040 <font class="keyword">    </font>{ <font class="keywordflow">return</font> find(section) != end(); }
00041 
00042     <font class="keywordtype">bool</font> Exists( std::string section,
00043                  std::string token) <font class="keyword">const</font>;
00044 
00045     std::string getStringValue( std::string section,
00046                                 std::string token,
00047                                 std::string def) <font class="keyword">const</font>;
00048     <font class="keywordtype">int</font> getIntValue( std::string section,
00049                      std::string token,
00050                      <font class="keywordtype">int</font> def ) <font class="keyword">const</font>;
00051 
00052 <font class="preprocessor">#if USE_MEMBER_TEMPLATES</font>
00053 <font class="preprocessor"></font>    template &lt;class T&gt;
00054      <font class="keyword">const</font> T&amp; getValue( std::string section,
00055                         std::string token,
00056                         <font class="keyword">const</font> T&amp; def)<font class="keyword"> const</font>
00057 <font class="keyword">    </font>{
00058       <font class="comment">// find section</font>
00059 
00060       const_iterator section_it = find(section);
00061 
00062       <font class="keywordflow">if</font> (section_it != end())
00063       {
00064         <font class="comment">// find token</font>
00065 
00066         const_section_iterator token_it = (*section_it).second.find(token);
00067 
00068         <font class="keywordflow">if</font> (token_it != (*section_it).end())
00069         {
00070           <font class="comment">// extract value with stream</font>
00071           T value;
00072           std::istrstream s((*token_it).second);
00073           s &gt;&gt; value;
00074 
00075           <font class="keywordflow">if</font> (s)
00076             <font class="keywordflow">return</font> value;
00077         }
00078       }
00079 
00080       <font class="keywordflow">return</font> def;
00081     }
00082 <font class="preprocessor">#endif</font>
00083 <font class="preprocessor"></font>};
00084 
00085 <font class="keyword">inline</font> <font class="keywordtype">bool</font> IniFile::Exists( std::string section,
00086                              std::string token)<font class="keyword"> const</font>
00087 <font class="keyword"></font>{
00088   const_iterator section_it = find(section);
00089   <font class="keywordflow">return</font> section_it != end()
00090       &amp;&amp; (*section_it).second.find(token) != (*section_it).second.end();
00091 }
00092 
00093 template &lt;class T&gt;
00094 T getValue(<font class="keyword">const</font> IniFile&amp; inifile, std::string section,
00095                   std::string token, <font class="keyword">const</font> T&amp; def)<font class="keyword"></font>
00096 <font class="keyword"></font>{
00097   <font class="comment">// find section</font>
00098 
00099   IniFile::const_iterator section_it = inifile.find(section);
00100 
00101   <font class="keywordflow">if</font> (section_it != inifile.end())
00102   {
00103     <font class="comment">// find token</font>
00104 
00105     IniFile::const_section_iterator token_it = (*section_it).second.find(token);
00106 
00107     <font class="keywordflow">if</font> (token_it != (*section_it).second.end())
00108     {
00109       <font class="comment">// extract value with stream</font>
00110       T value;
00111 
00112       <font class="keywordflow">if</font> (std::istringstream((*token_it).second) &gt;&gt; value)
00113         <font class="keywordflow">return</font> value;
00114     }
00115   }
00116 
00117   <font class="keywordflow">return</font> def;
00118 }
00119 
00120 <font class="keyword">inline</font> <font class="keywordtype">int</font> IniFile::getIntValue( std::string section,
00121                  std::string token,
00122                  <font class="keywordtype">int</font> def )<font class="keyword"> const</font>
00123 <font class="keyword"></font>{
00124   <font class="keywordflow">return</font> getValue(*<font class="keyword">this</font>, section, token, def);
00125 }
00126 
00127 std::ostream&amp; operator &lt;&lt; (std::ostream&amp; out, <font class="keyword">const</font> IniFile&amp; ini);
00128 
00129 <font class="preprocessor">#endif // INILIB_H</font>
</font></pre></div><hr><address><small>Erzeugt am Thu May 30 22:54:12 2002 für C++Utilities von
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.9.1 geschrieben von <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
